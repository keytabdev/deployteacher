(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2605],{8976:function(e,t,a){Promise.resolve().then(a.bind(a,5863))},5863:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var r=a(9268),s=a(6006),n=a(8856),o=a(771),i=a(9131),l=a(8919),u=a(4824),c=a(4496),d=a(8852),h=a(1791),g=a(6008),m=a(443),p=a(4088);function f(e){let{token:t,grade:a}=e,{courses:f,lessons:v,users:b,course:y,setCourse:x,lesson:w,setLesson:Z,user:j,setUser:B,handleChange:N,handleSubmit:C,values:S,errors:A,loading:z}=function(e,t){var a,r,m,p;let{grade_value:f,lesson_id:v,course_id:b,user_id:y}=t.data.attributes,x=(0,g.useRouter)(),w=(0,u.useQueryClient)(),[Z,j]=(0,s.useState)([]),[B,N]=(0,s.useState)([]),[C,S]=(0,s.useState)([]),[A,z]=(0,s.useState)({value:(null===(a=b.data)||void 0===a?void 0:a.id.toString())||"",label:(null===(r=b.data)||void 0===r?void 0:r.attributes.title)||""}),[k,_]=(0,s.useState)({value:(null===(m=v.data)||void 0===m?void 0:m.id.toString())||"",label:(null===(p=v.data)||void 0===p?void 0:p.attributes.title)||""}),[I,P]=(0,s.useState)({value:y.data.id.toString(),label:y.data.attributes.username}),{data:T}=(0,u.useQuery)(["select-courses"],()=>n.Z.getCourses(e,"?fields[0]=title"),{staleTime:1/0,onError:()=>l.ZP.error("something went wrong, please try again")}),{data:E}=(0,u.useQuery)(["select-lessons"],()=>o.Z.getLessons(e,"?fields[0]=title"),{staleTime:1/0,onError:()=>l.ZP.error("something went wrong, please try again"),onSuccess:e=>{N(e.data.map(e=>({value:e.id.toString(),label:e.attributes.title})))}}),{data:L}=(0,u.useQuery)(["users"],()=>(0,i.Rf)(e),{staleTime:1/0,onError:()=>l.ZP.error("something went wrong, please try again")}),{handleChange:V,handleSubmit:D,values:R,errors:F}=(0,d.TA)({initialValues:{gradeValue:f},validationSchema:c.i,async onSubmit(e){await G(e)}}),{mutateAsync:Q,isLoading:q}=(0,u.useMutation)(a=>h.Z.update(e,t.data.id.toString(),a),{onSuccess:async()=>await w.invalidateQueries(["grades"])});async function G(e){try{let e={data:{grade_value:R.gradeValue,course_id:null==A?void 0:A.value,lesson_id:null==k?void 0:k.value,user_id:null==I?void 0:I.value}};await Q(e),l.ZP.success("Grade updated successfully"),x.push("/dashboard/grades")}catch(e){l.ZP.error(e.response.data.error.message||"something went wrong, please try again!")}}return(0,s.useEffect)(()=>{T&&j(T.data.map(e=>({value:e.id.toString(),label:e.attributes.title}))),E&&N(E.data.map(e=>({value:e.id.toString(),label:e.attributes.title}))),L&&S(L.map(e=>({value:e.id.toString(),label:e.username})))},[T,L,E]),{courses:Z,lessons:B,users:C,course:A,setCourse:z,lesson:k,setLesson:_,user:I,setUser:P,handleChange:V,handleSubmit:D,values:R,errors:F,loading:q}}(t,a);return(0,r.jsxs)(r.Fragment,{children:[" ",(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-xl font-bold",children:"Create a new grade"}),(0,r.jsx)("p",{children:"Add the information about the grade"})]}),(0,r.jsxs)("form",{onSubmit:C,className:"rounded-md bg-white p-3 shadow-md dark:bg-darkBg",action:"",children:[(0,r.jsx)("div",{className:"mb-12",children:(0,r.jsx)(m.II,{name:"gradeValue",value:S.gradeValue,onChange:N,error:A.gradeValue,label:"Grade value",variant:"filled"})}),(0,r.jsxs)("div",{className:"mb-12 grid grid-cols-1 gap-12  md:grid-cols-2 md:gap-8",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"",className:"mb-2 text-sm",children:"Choose a course"}),(0,r.jsx)(p.ZP,{value:y,onChange:e=>x({value:null==e?void 0:e.value.toString(),label:null==e?void 0:e.label}),options:f})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"",className:"mb-2 text-sm",children:"Choose a lesson"}),(0,r.jsx)(p.ZP,{value:w,onChange:e=>Z({value:null==e?void 0:e.value.toString(),label:null==e?void 0:e.label}),options:v})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"",className:"mb-2 text-sm",children:"Choose a user"}),(0,r.jsx)(p.ZP,{value:j,onChange:e=>B({value:null==e?void 0:e.value.toString(),label:null==e?void 0:e.label}),options:b})]})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(m.zx,{loading:z,type:"submit",className:"w-fit text-white",children:"Create grade"})})]})]})}},443:function(e,t,a){"use strict";a.d(t,{zx:function(){return r.default},II:function(){return s.default},gx:function(){return i},ZD:function(){return l}});var r=a(4769);a(9510);var s=a(445);a(9743),a(3402);var n=a(9268);a(6006);let o={outline:"bg-white",filled:"bg-gray-100 dark:bg-primaryBg border-2 border dark:border-gray-500 dark:focus-within:border-primary focus-within:border-primary"};var i=function(e){let{label:t,variant:a,error:r,...s}=e;return(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("label",{htmlFor:"",className:"mb-2 text-sm",children:t}),(0,n.jsx)("textarea",{...s,className:"h-[200px] resize-none  rounded-md px-2 py-3 outline-none ".concat(o[a])}),r&&(0,n.jsx)("small",{className:"mt-1 text-sm text-red-500",children:r})]})};function l(e){let{title:t,value:a,onChange:r,name:s}=e;return(0,n.jsxs)("label",{className:"relative w-fit inline-flex items-center cursor-pointer",children:[(0,n.jsx)("input",{name:s,onChange:r,type:"checkbox",checked:a,className:"sr-only peer"}),(0,n.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"}),(0,n.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:t})]})}},4737:function(e,t,a){"use strict";var r=a(4214),s=a(8611);let n=r.default.create({baseURL:"".concat(s.env.NEXT_PUBLIC_BASE_URL,"/api"),headers:{"Content-Type":"application/json"}});t.Z=n},8856:function(e,t,a){"use strict";var r=a(4737);t.Z=class{static async createCourse(e,t){let a=await r.Z.post("/courses",t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});return a.data}static updateCourse(e,t,a){return r.Z.put("/courses/".concat(t),a,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}})}static async getCourseByID(e,t){return await r.Z.get("/courses/".concat(t,"?populate[instructor_id]=*&populate[course_image]=*&populate[tags][fields][0]=name&populate[lessons]=*"),{headers:{Authorization:"Bearer ".concat(e)}})}static async deleteByID(e,t){return await r.Z.delete("/courses/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}})}static async getCourses(e,t){let a=await r.Z.get("/courses?".concat(t||""),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}}},1791:function(e,t,a){"use strict";var r=a(4737);t.Z=class{static async getGrades(e,t){let a=await r.Z.get("/grades?".concat(t||""),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async getByID(e,t){let a=await r.Z.get("/grades/".concat(t,"?populate=*"),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async deleteByID(e,t){let a=await r.Z.delete("/grades/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async create(e,t){let a=await r.Z.post("/grades",t,{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async update(e,t,a){let s=await r.Z.put("/grades/".concat(t),a,{headers:{Authorization:"Bearer ".concat(e)}});return s.data}}},771:function(e,t,a){"use strict";var r=a(4737);t.Z=class{static async getLessons(e,t){let a=await r.Z.get("/lessons?".concat(t||""),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async getLessonById(e,t){let a=await r.Z.get("/lessons/".concat(t,"?populate[course][populate][course_image]=*&populate[thumbnail]=*&populate[media]=*&populate[course][populate][instructor_id]=*"),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async deleteByID(e,t){let a=await r.Z.delete("/lessons/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async createLesson(e,t){let a=await r.Z.post("/lessons",t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});return a.data}static async updateLesson(e,t,a){let s=await r.Z.put("/lessons/".concat(t),a,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});return s.data}}},9131:function(e,t,a){"use strict";a.d(t,{M1:function(){return n},Nq:function(){return o},Rf:function(){return s},XB:function(){return i}});var r=a(4737);a(8611);let s=async(e,t)=>{let a=await r.Z.get("/users".concat(t||""),{headers:{Authorization:"Bearer ".concat(e)}});return a.data},n=async(e,t)=>{let a=await r.Z.post("/auth/local/register",t);return a.data},o=async(e,t,a)=>{let s=await r.Z.put("/users/".concat(t),a,{headers:{Authorization:"Bearer ".concat(e)}});return s.data},i=async(e,t)=>{let a=await r.Z.delete("/users/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}},4496:function(e,t,a){"use strict";a.d(t,{i:function(){return s}});var r=a(353);let s=r.Ry({gradeValue:r.Z_().trim("grade value should be valid").required("grade value is required")})}},function(e){e.O(0,[5625,6680,6415,7079,3287,3296,1827,2162,1420,7240,4824,4214,5600,4088,1644,9253,2961,1744],function(){return e(e.s=8976)}),_N_E=e.O()}]);