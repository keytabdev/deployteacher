(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3174],{5804:function(e,t,a){Promise.resolve().then(a.bind(a,511)),Promise.resolve().then(a.bind(a,4769)),Promise.resolve().then(a.bind(a,9510)),Promise.resolve().then(a.bind(a,445)),Promise.resolve().then(a.bind(a,9743)),Promise.resolve().then(a.bind(a,3402))},511:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var r=a(9268),s=a(443),n=a(6006),i=a(4088),l=a(8856),o=a(9131),c=a(2855),d=a(8852),u=a(6008),m=a(8919),h=a(4824),p=a(9457),f=a(3593),x=function(e){var t;let{session:a}=e,{values:x,errors:g,handleChange:v,handleSubmit:b,loading:j,image:y,setImage:w,instructorId:N,setInstructorId:Z,users:C,tags:B,selectedTags:k,setSelectedTags:_}=function(e){let t=(0,u.useRouter)(),a=(0,h.useQueryClient)(),[r,s]=(0,n.useState)({value:"",label:""}),[i,f]=(0,n.useState)([]),[x,g]=(0,n.useState)({image:null,error:"",dataURL:void 0}),{values:v,errors:b,handleChange:j,handleSubmit:y}=(0,d.TA)({initialValues:{name:"",description:"",startDate:"",endDate:"",isPublished:!1},validationSchema:c.U,onSubmit(e){B(e)}}),{isLoading:w,mutateAsync:N}=(0,h.useMutation)([e],t=>l.Z.createCourse(e,t),{onSuccess:async e=>{let{data:r}=e;await a.invalidateQueries("select-courses"),m.ZP.success("course created successfully"),t.push("/dashboard/courses/".concat(r.id))}}),{data:Z}=(0,h.useQuery)(["users"],()=>(0,o.Rf)(e),{onError:()=>m.ZP.error("something went wrong while fetching the users please try again!"),staleTime:1/0}),{data:C}=(0,h.useQuery)(["tags"],()=>p.Z.getTags(e,"?fields[0]=name"),{onError:()=>m.ZP.error("something went wrong while fetching the tags please try again!"),staleTime:1/0});async function B(e){if(!x.image){g({...x,error:"please choose course image"});return}if(!r.value){m.ZP.error("please choose instructor");return}try{let t=new FormData;t.append("data",JSON.stringify({instructor_id:r.value,title:e.name,description:e.description,start_date:e.startDate,end_date:e.endDate,tags:[...i.map(e=>e.value)]})),t.append("files.course_image",x.image),await N(t)}catch(e){m.ZP.error(e.response.data.message||"something went wrong, please try again!")}}return{values:v,errors:b,handleChange:j,handleSubmit:y,loading:w,image:x,setImage:g,setInstructorId:s,instructorId:r,users:Z,tags:C,selectedTags:i,setSelectedTags:f}}(null==a?void 0:a.token),A=null==C?void 0:C.map(e=>({value:"".concat(e.id),label:e.username})),D=null==B?void 0:null===(t=B.data)||void 0===t?void 0:t.map(e=>{let{id:t,attributes:a}=e;return{value:"".concat(t),label:a.name}});return(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-xl font-bold",children:"Create a new course"}),(0,r.jsx)("p",{children:"Add the information about the course"})]}),(0,r.jsxs)("form",{onSubmit:b,className:"rounded-md p-3 shadow-md",action:"",children:[(0,r.jsx)("div",{className:"mb-12",children:(0,r.jsx)(s.II,{name:"name",value:x.name,onChange:v,error:g.name,label:"Course name",variant:"filled"})}),(0,r.jsx)("div",{className:"mb-12",children:(0,r.jsx)(s.gx,{name:"description",value:x.description,onChange:v,error:g.description,label:"Course description",variant:"filled"})}),(0,r.jsx)("div",{className:"mb-12",children:(0,r.jsx)(f.Z,{label:"Choose course image",state:y,setState:w})}),(0,r.jsxs)("div",{className:"mb-12 grid grid-cols-1 gap-12  md:grid-cols-2 md:gap-8",children:[(0,r.jsx)(s.II,{name:"startDate",value:x.startDate.toString(),onChange:v,label:"Start date",type:"date",variant:"filled",error:g.startDate}),(0,r.jsx)(s.II,{name:"endDate",value:x.endDate.toString(),onChange:v,label:"End date",type:"date",error:g.endDate,variant:"filled"})]}),(0,r.jsxs)("div",{className:"mb-12 grid grid-cols-1 gap-12  md:grid-cols-2 md:gap-8",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"",className:"mb-2 text-sm",children:"Choose a instructor"}),(0,r.jsx)(i.ZP,{value:N,onChange:e=>Z({value:null==e?void 0:e.value.toString(),label:null==e?void 0:e.label}),options:A})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"",className:"mb-2 text-sm",children:"Choose tags"}),(0,r.jsx)(i.ZP,{value:k,onChange:e=>{_(e.map(e=>({value:e.value,label:e.label})))},options:D,isMulti:!0})]})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(s.zx,{type:"submit",loading:j,className:"w-fit text-white",children:"Create course"})})]})]})}},3593:function(e,t,a){"use strict";a.d(t,{Z:function(){return m}});var r=a(9268),s=a(6394),n=a.n(s),i=a(6006),l=a(8919),o=a(1033),c=a(5372),d=a(9743),u=a(4769);function m(e){let{state:t,setState:a,label:s,url:m,thumbnail:h}=e,p=(0,i.useId)();async function f(e){let r=e.target.files;if(!r){a({...t,error:"please choose course image"});return}let s=new FileReader;s.readAsArrayBuffer(r[0]),s.addEventListener("error",()=>l.Am.error("cannot load the media please try choosing again!")),s.addEventListener("load",e=>{var s;let n=null===(s=e.target)||void 0===s?void 0:s.result;if(!n)return;let i=new Blob([n],{type:r[0].type}),l=URL.createObjectURL(i);a({...t,image:r[0],dataURL:l})})}return(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"",className:"mb-2 text-sm",children:s}),t.image||!m?t.image?(0,r.jsxs)("div",{className:"relative flex flex-col gap-4",children:[t.image.type.includes("image")?(0,r.jsx)("div",{className:"relative h-[300px] w-full overflow-hidden rounded-md",children:(0,r.jsx)(n(),{src:"".concat(t.dataURL),alt:"",fill:!0,className:"rounded-md object-cover"})}):t.image.type.includes("pdf")?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(d.default,{url:t.dataURL})}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("video",{className:" h-[300px] w-[500px]  rounded-md object-cover",controls:!0,children:(0,r.jsx)("source",{src:"".concat(t.dataURL),type:"video/mp4"})},"".concat(t.dataURL))}),(0,r.jsx)("label",{onClick:function(){a({...t,image:null})},htmlFor:"",className:"absolute right-[0.5em] top-[0.5em] flex cursor-pointer items-center justify-center rounded-full bg-gray-100 p-4 text-xl dark:bg-primaryBg dark:text-white",children:(0,r.jsx)(o.oHP,{})})]}):(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"flex h-[200px] w-full max-w-[250px] items-center justify-center rounded-s-md border border-gray-300",children:[(0,r.jsx)("label",{htmlFor:p,children:(0,r.jsxs)("div",{className:"flex cursor-pointer flex-col items-center justify-center gap-2 ",children:[(0,r.jsx)(c.tpQ,{className:"text-3xl"}),(0,r.jsx)("p",{className:"text-sm",children:"choose file to upload"})]})}),(0,r.jsx)("input",{onChange:f,type:"file",id:p,className:"hidden"})]}),t.error&&(0,r.jsx)("small",{className:"text-red-400",children:t.error})]}):(0,r.jsxs)("div",{children:[(null==m?void 0:m.match(/jpeg|png|jpg|webp/))?(0,r.jsx)("div",{className:"relative h-[300px] w-full overflow-hidden rounded-md",children:(0,r.jsx)(n(),{src:"".concat(m),alt:"",fill:!0,className:"rounded-md object-cover"})}):(null==m?void 0:m.match(/pdf/))?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(u.default,{className:"text-primary bg-white border-primary",type:"button",onClick:()=>window.open("".concat(m),"__blank"),children:"Open PDF"})}):(0,r.jsx)("video",{className:"aspect-video rounded-md object-cover",controls:!0,children:(0,r.jsx)("source",{src:"".concat(m),type:"video/mp4"})}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{htmlFor:p,children:(0,r.jsxs)("div",{className:"flex cursor-pointer items-center gap-2 hover:text-primary",children:[(0,r.jsx)(c.tpQ,{className:"text-3xl"}),(0,r.jsx)("p",{className:"text-sm",children:"choose file to upload"})]})}),(0,r.jsx)("input",{onChange:f,type:"file",id:p,className:"hidden"})]})]})]})}a(6628)},443:function(e,t,a){"use strict";a.d(t,{zx:function(){return r.default},II:function(){return s.default},gx:function(){return l},ZD:function(){return o}});var r=a(4769);a(9510);var s=a(445);a(9743),a(3402);var n=a(9268);a(6006);let i={outline:"bg-white",filled:"bg-gray-100 dark:bg-primaryBg border-2 border dark:border-gray-500 dark:focus-within:border-primary focus-within:border-primary"};var l=function(e){let{label:t,variant:a,error:r,...s}=e;return(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("label",{htmlFor:"",className:"mb-2 text-sm",children:t}),(0,n.jsx)("textarea",{...s,className:"h-[200px] resize-none  rounded-md px-2 py-3 outline-none ".concat(i[a])}),r&&(0,n.jsx)("small",{className:"mt-1 text-sm text-red-500",children:r})]})};function o(e){let{title:t,value:a,onChange:r,name:s}=e;return(0,n.jsxs)("label",{className:"relative w-fit inline-flex items-center cursor-pointer",children:[(0,n.jsx)("input",{name:s,onChange:r,type:"checkbox",checked:a,className:"sr-only peer"}),(0,n.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary"}),(0,n.jsx)("span",{className:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:t})]})}},4737:function(e,t,a){"use strict";var r=a(4214),s=a(8611);let n=r.default.create({baseURL:"".concat(s.env.NEXT_PUBLIC_BASE_URL,"/api"),headers:{"Content-Type":"application/json"}});t.Z=n},8856:function(e,t,a){"use strict";var r=a(4737);t.Z=class{static async createCourse(e,t){let a=await r.Z.post("/courses",t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}});return a.data}static updateCourse(e,t,a){return r.Z.put("/courses/".concat(t),a,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"}})}static async getCourseByID(e,t){return await r.Z.get("/courses/".concat(t,"?populate[instructor_id]=*&populate[course_image]=*&populate[tags][fields][0]=name&populate[lessons]=*"),{headers:{Authorization:"Bearer ".concat(e)}})}static async deleteByID(e,t){return await r.Z.delete("/courses/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}})}static async getCourses(e,t){let a=await r.Z.get("/courses?".concat(t||""),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}}},9457:function(e,t,a){"use strict";var r=a(4737);t.Z=class{static async getTags(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=await r.Z.get("/tags".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async getTagByID(e,t){let a=await r.Z.get("/tags/".concat(t,"?populate=*"),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async createTag(e,t){let a=await r.Z.post("/tags",t,{headers:{Authorization:"Bearer ".concat(e)}});return a.data}static async updateTag(e,t,a){let s=await r.Z.put("/tags/".concat(t),a,{headers:{Authorization:"Bearer ".concat(e)}});return s.data}static async deleteTag(e,t){let a=await r.Z.delete("/tags/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}}},9131:function(e,t,a){"use strict";a.d(t,{M1:function(){return n},Nq:function(){return i},Rf:function(){return s},XB:function(){return l}});var r=a(4737);a(8611);let s=async(e,t)=>{let a=await r.Z.get("/users".concat(t||""),{headers:{Authorization:"Bearer ".concat(e)}});return a.data},n=async(e,t)=>{let a=await r.Z.post("/auth/local/register",t);return a.data},i=async(e,t,a)=>{let s=await r.Z.put("/users/".concat(t),a,{headers:{Authorization:"Bearer ".concat(e)}});return s.data},l=async(e,t)=>{let a=await r.Z.delete("/users/".concat(t),{headers:{Authorization:"Bearer ".concat(e)}});return a.data}},2855:function(e,t,a){"use strict";a.d(t,{U:function(){return s}});var r=a(353);let s=r.Ry({name:r.Z_().trim("course  name should be valid").required("course name is required"),description:r.Z_().trim("course description is required").required("course description is required"),startDate:r.Z_().required("start date is required"),endDate:r.Z_().required("end date is required"),isPublished:r.O7().default(!1)})},6628:function(){}},function(e){e.O(0,[5625,6680,6415,7079,3287,3296,1827,2162,8121,9173,1420,7240,4824,4214,5600,4088,1403,1644,9253,2961,1744],function(){return e(e.s=5804)}),_N_E=e.O()}]);